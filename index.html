<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
      
      <div class = "logo">
        <p>MERCURY <br>DEVELOPMENT<p>
     
      </div>
      <!-- Форма Desctop1 из дизайн-спецификации -->
      <div class = "desctop1" id = "desctop1" style = "display:block">
        <form name = "authorization1" class = "authorization1" >
          <label class = "log_in">Log in</label>
          <input type = "e-mail" name = "e-mail1" id = "e-mail1" placeholder = "E-Mail" required>
          <input type = "password" name = "password1" id = "password1" placeholder = "Password" required>
         <div class = "button_login1">
            <button type="submit" class = "button1" id = "button1">Login</button>
          </div>
        </form>
      </div>
      <!-- Форма Desctop3 из дизайн-спецификации. После непройденной авторизации -->
      <div class = "desctop3" id = "desctop3" style = "display:none">
        <form name = "authorization" class = "authorization2"  >
          <label class = "log_in">Log in</label>
          <input  type = "e-mail" name = "e-mail2" id = "e-mail2" placeholder = "E-mail" required>
          <input type = "password" name = "password2" id = "password2" placeholder = "Password" required>
          <input class = "error" type="text" name = "error" id = "error" value = "E-Mail or password is incorrect">
          <div class = "button_login2">
            <button class = "button2" id = "button2" type="submit">Login</button>
          </div>
        </form>
      </div>
      <!-- Форма Desctop4 из дизайн-спецификации. После успешной авторизации -->
      <div class = "desctop4" style = "display:none" id = "desctop4">
        <form name = "authorization3" class = "authorization3" >
          <div class = "img_avatar">
            <img class = "avatar" src="https://i.ibb.co/ZgVB2pV/Oval-2.png" alt="Oval-2" border="0">
          </div>
          <label class = "username">Helena Joseph</label>
          
          <div class = "button_login3">
            <button class = "button3" id = "button3" type="submit">Logout</button>
          </div>
      </form>
      </div>
      
      <script>
        var loginButton = document.querySelector('.button1');
        loginButton.addEventListener("click", function() {
          alert('1');
          var user = document.getElementById("e-mail1").value;
          var password = document.getElementById("password1").value;
          var userData = {
           email: "",
           password: ""
          };
          userData.email = user;
          userData.password = password;
          //создание JSON с двумя полями: email и password 
          var json = JSON.stringify(userData);
          //отправка POST-запроса
          var xhr = new XMLHttpRequest();
          xhr.open("POST", 'https://us-central1-mercdev-academy.cloudfunctions.net/login', false)
          xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');
          xhr.send(json);

        //изменение окна в зависимости от пройденной / непройденной авторизации
         //  сделать невидимой начальную форму авторизации
        document.getElementById('desctop1').style.display = "none"; //Скрываем элемент
        if (xhr.status == 200) {
          // сделать видимой форму с аватаром
          document.getElementById('desctop4').style.display = "block";
        } else {
          //  сделать видимой форму с ошибкой
          document.getElementById('desctop3').style.display = "block"; 
        }

     });
     //действие при нажатии входа на форме с ошибочными данными
     var loginButton = document.getElementById('button2');
        loginButton.addEventListener("click", function() {
          var user = document.getElementById("e-mail2").value;
          var password = document.getElementById("password2").value;
          var userData = {
           email: "",
           password: ""
          };
          userData.email = user;
          userData.password = password;
          //создание JSON с двумя полями: email и password 
          var json = JSON.stringify(userData);
          //отправка POST-запроса
          var xhr = new XMLHttpRequest();
          xhr.open("POST", 'https://us-central1-mercdev-academy.cloudfunctions.net/login', false)
          xhr.setRequestHeader('Content-type', 'application/json; charset=utf-8');
          xhr.send(json);

        //изменение окна в зависимости от пройденной / непройденной авторизации
         //  сделать невидимой начальную форму авторизации
        
        if (xhr.status == 200) {
          // сделать видимой форму с аватаром
          document.getElementById('desctop3').style.display = "none"; //Скрываем элемент
          document.getElementById('desctop4').style.display = "block";
          
        } else {
          //  сделать видимой форму с ошибкой
          document.getElementById('desctop3').style.display = "block"; 
        }
     });
    //действие при нажатии Logout на форме с аватаром
     var loginButton = document.getElementById('button3');
    loginButton.addEventListener("click", function() {
          document.getElementById('desctop4').style.display = "none";
          document.getElementById('desctop1').style.display = "block";
        });
    </script> 
  </body>
</html>

